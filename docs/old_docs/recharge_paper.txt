Development of a process-based modeling Informed machine learning 
 
1. Statement of the problem
Michigan's groundwater (GW) resources are under growing pressure due to increasing demand across various sectors, such as agriculture, public water supply, and industry (Steinman et al., 2022). Meanwhile, climate change has been projected to alter precipitation patterns across the Midwest, intensify rainfall events, and increase evapotranspiration rates, and therefore, contribute to reduced GW recharge and availability (Costa et al., 2021). These challenges may be further exacerbated by the expansion of impervious surfaces and the widespread use of agricultural subsurface drainage, posing threats to the long-term sustainability of Michigan's GW resources, which are crucial for the state's economy, ecology, and human populations.
To effectively address these challenges, a comprehensive approach is needed that integrates the influences of climate change, land use change, and growing demand into developing efficient conservation management practices. However, two critical issues must be addressed: improved data on groundwater hydraulic property (transmissivity, static head, aquifer depth, etc.). Second, we require the ability to forecast the impact of environmental and anthropogenic activities on GW recharge quality and quantity at a large scale. 
Machine Learning (ML) algorithm has been used widely for predicting GW systems dynamics, including mapping the spatial distribution of GW salinity and predicting GW level (Pourghasemi et al., 2020), determining the physical properties of aquifers, and predicting the GW response to drought (Schreiner-McGraw and Ajami, 2021). However, machine learning models for predicting recharge or other parameters require observation data that are not available. The next option is simulation data from process-based modeling that can provide data at various temporal or spatial scales. In the literature, there are numerous examples of physics-informed ML machine learning. For example, Wang et al. (2022) addressed the challenge of assessing spatiotemporal variations of GW contamination under climate change scenarios by developing a physics-informed ML surrogate model called U-Net enhanced Fourier Neural Operator (U-FNO). The proposed model could solve partial differential equations for GW flow and transport simulations at the site scale. Moreover, the hypothesis that theory-guided ML models can effectively model the behavior of an actual aquifer has been examined by Adombi et al. (2022). The authors conducted one of the first comparative analyses of numerical modeling, traditional ML, and theory-guided ML to model GW dynamics. The researchers developed a theory-guided multilayer perceptron model (TgMLP) for simulating aquifers. They compared its performance with a numerical model (NumMod) and a traditional multilayer perceptron model (MLP) in simulating GW flow dynamics. They found that the TgMLP model better approximated the solution of the partial differential equation at 70% of the locations than other models.  
However, despite the proven effectiveness of machine learning and deep learning, the problem with data that these machine learning needs to be fed remains a challenge. Not only that, the scaling of these machine learning to state and continental levels where heterogeneity, resolution, and scaling of processes are major issues has not been addressed. Therefore, the extent of the ability of machine learning models to forecast future changes (which are exceptionally dependent on the data) has not been addressed. 
	Drawing from the acknowledged challenges and research advancements, we propose a novel data science approach for training ML algorithms based on high-resolution processes-based models to estimate recharge under diverse environmental conditions.  To achieve our goal, we developed a highly scalable system for generating SWAT+ for the Conterminous United States based on the national high-resolution hydrographical dataset (NHDPlus HR). We incorporated more than 600,000 water well information for estimating groundwater properties and groundwater water hydraulic variables to generate high-resolution groundwater models and further used in training machine learning for future prediction. We overall used 47 models across Michigan's lower peninsula to train a deep-learning neural network and examine several aspects of such development. 

Our proposed approach and platform offer numerous advantages for empowering policymakers, and stakeholders with actionable insights for preserving GW resources at the most granular level. The key benefits include:

1- Estimation of GW recharge rates across Michigan under diverse environmental and anthropogenic activities.
2- Identification and prioritization of vulnerable areas for enhancing recharge.
3- The potential to serve as a model for other regions, inspiring broader advancements in 		GW management and sustainability.

This project provides an interdisciplinary approach, integrating hydrogeology, data science, and ML to develop a comprehensive process-based model-guided machine learning. 

The project's nature focuses on developing models that incorporate various factors influencing GW recharge and identifying feasible methods to enhance the state's GW resource management. The objective of the project consists of the following components:
1- Developing a scalable system for creating a high-resolution groundwater-surface model for training machine learning and deep learning models. 
2- Developing a machine learning method capable of learning processes from a process-based model and predicting the future based on the processes. 
3- Estimating Michigan groundwater recharge at high resolution. 

3.3. Climate Change Analysis
	We have calibrated and validated 46 SWAT+ models, and for each model, we executed 26 different climate change models with different ensemble datasets (85 different simulations for each SWAT+ model). As described, the SWAT+ models were calibrated with the PRISM dataset between 2008 and 2015 with a three-year warmup period. The objective of the calibration process was to achieve the lowest error in monthly cumulative flow and daily streamflow rates among all stations within a watershed (most watersheds have only one station). We found this objective function reliable enough to preserve water balance (by accounting for monthly cumulative flow) and optimize concentration time by daily rate. 
	For the model validation, we selected the global best-fitted parameters and four local optima (each particle in PSO has one local optimum). For each set of parameters, we executed SWAT+ models between 1997 and 2022, and the best set of calibrated parameters that resulted in the lowest overall error was selected for climate change analysis. The aim of this validation approach was two-folded: 1- to ensure the best set of parameters for the validation period has been selected, and 2- the average performance of the five different sets of calibrated parameters will be more reliable than a single evaluation.   
3.3.1 Overview of Performance
	Here, we present the performance metrics of 46 SWAT+ models for monthly time steps executed for 85 climate change datasets (LOCA2), plus the performance of SWAT+ models (with PRISM dataset) for five sets of different calibrated parameters. Table 1 summarizes the statistics of the performance metrics for the SWAT+ models under the LOCA2 and PRISM datasets. The median NSE for SWAT+ models with the PRISM dataset is 0.45±0.71 with a range of -4.30 to 0.78 and the PBIAS ranging from -50% to 50%. In comparison, the median of NSE for LOCA2 is -0.3±1.7, with a range of -25 to 0.16, and the range of PBIAS is from -70% to 90%. The distribution of NSE, PBIAS, and MPE of SWAT+ models with LOCA2 and PRISM datasets is provided in Figures 1, 2, and 3. 
Table X. Statistical summary of SWAT+ models’ performance metrics with LOCA2 and PRISM datasets.

	Figure X shows the distribution of NSE coefficient performance for 45 models executed with 85 historical LOCA2 datasets and the PRISM dataset. Apparently, the average mean of NSE in models executed by the PRISM dataset is significantly different from the average of those executed by LOCA2. These results suggest that the monthly predictive performance of the models with LOCA2 is not reliable compared to the models executed with the PRISM dataset.  

Figure 6. Distribution of NSE of 46 SWAT+ models executed LOCA2 and PRISM datasets.

Figure 7. Distribution of PBIAS of 46 SWAT+ models executed LOCA2 and PRISM datasets.


Figure 8. Distribution of MPE of 46 SWAT+ models executed LOCA2 and PRISM datasets.
3.3.2. ANOVA Results for NSE, PBIAS, and MPE
	We employed a two-way ANOVA test to 1) determine if there are significant differences in the performance metrics (NSE, PBIAS, and MPE) due to the choice of climate change models and 2) examine if the effect of the climate change model on the performance metrics depends on the specific SWAT+ model used. This interaction effect can reveal if certain combinations of climate change models and SWAT+ models perform differently than expected from their individual effects. 
	The ANOVA results on climate change models show a low p-value (< 0.05), indicating significant differences in NSE among different climate change models. This means that the choice of climate change model affects the predictive accuracy (NSE) of the SWAT+ models. This is also true about PBIAS and indicates significant differences between PBIAS generated by different climate change models, independent of the choice of SWAT+ models. However, there is no significant difference in the MPE, suggesting that the error magnitudes (MPE) are similar across models and independent of the choice of SWAT+ models. 
	For the interaction effect, the ANOVA tests show a high p-value (>0.05) for all three performance metrics, implying no significant interaction between the climate change dataset and SWAT+ models for NSE, PBIAS, and MPE. The lack of significant interaction effects suggests that the impact of climate change models on these metrics is consistent across different SWAT+ models. 
3.3.3. Performance metric and ranking among different climate change models.
	The analysis and evaluation of the performance of different climate change data combinations were conducted using three key metrics: Nash-Sutcliffe Efficiency (NSE), Mean Percent Error (MPE), and Percent Bias (PBIAS). These metrics were averaged and ranked for each climate change model, and an overall rank was determined by averaging the ranks of these metrics. Based on this, the best-performing model was found to be FGOALS-g3, with an overall rank of 7. The model consistently performed well across all metrics, ranking 6th in NSE and PBIAS and 9th in MPE. Other notable models include:
MPI-ESM1-2-HR, with an overall rank of 9, performed excellently in PBIAS (rank 1) but slightly lower in MPE (rank 16).
MRI-ESM2-0 has an overall rank of 10, balanced across all metrics with 9th, 7th, and 14th ranks in NSE, PBIAS, and MPE, respectively.

Figure 9. Overall rank of different climate change models 
Top Performers in NSE
GFDL-ESM4 (Average NSE: -0.27) has the highest average NSE value among the models evaluated. Although still negative, it is the least negative, indicating the best predictive performance relative to the other models in this dataset.
CNRM-CM6-1-HR (Average NSE: -0.42) ranks second in average NSE, showing relatively better predictive accuracy than most other models.
ACCESS-ESM1-5 (Average NSE: -0.43) is the third-best performer in terms of NSE, indicating it has relatively good predictive performance among the models evaluated.
Worst Performers in NSE
NorESM2-MM (Average NSE: -0.91) NorESM2-MM has the lowest average NSE value, indicating the poorest predictive performance among the models. It might significantly underperform compared to the observed data mean.
TaiESM1 (Average NSE: -0.88) TaiESM1 ranks second-last in average NSE, showing substantial prediction inaccuracies.
KACE-1-0-G (Average NSE: -0.88) KACE-1-0-G is tied with TaiESM1 for the second-last position, demonstrating poor predictive performance.
	Overall, the average NSE for all climate change models is negative, suggesting poor predictive performance for average monthly streamflow if compared with SWAT+ models’ NSE performance for the PRISM dataset. 

Figure 10. Average NSE for different climate change models (including the ensembles) among all SWAT+ models.
Percent Bias (PBIAS) Ranking
	The PBIAS metric measures the average tendency of the simulated values to be larger or smaller than their observed counterparts, with values closer to 0 indicating better performance. In this regard, most climate change models have an average PBIAS of less than 5% across different SWAT+ models, except NorESM2-MM, which resulted in more than 10% PBIAS.
Figure 11. Average PBIAS for different climate change models (including the ensembles) among all SWAT+ models.
	Overall, this evaluation highlights the strengths and weaknesses of various climate change models based on their performance across multiple metrics. While models like FGOALS-g3, MPI-ESM1-2-HR, and MRI-ESM2-0 performed relatively well across different models, other models such as NorESM2-MM and TaiESM1 performed relatively worse across different models in terms of both PBIAS and NSE. 
