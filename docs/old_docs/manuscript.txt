2.1. Hydrological model
2.2.1 Hydrological model development 
SWAT+ is a restructured version of the SWAT 2012 model, introducing several advancements that enhance its performance and usability. SWAT+ introduces three levels of land classification: basin, subbasin, and landscape, whereas SWAT 2012 only includes basin and subbasin levels. This change allows for a more detailed and accurate representation of landscapes, each containing an identifiable channel. Furthermore, the data management in SWAT+ has seen substantial improvements over SWAT 2012. The model utilizes relational tables to manage data, dramatically reducing the required input files. In SWAT 2012, a model with 10,000 Hydrologic Response Units (HRUs) could generate over 50,000 HRU files, resulting in millions of input files during parallel processing for calibration. The relational table approach in SWAT+ addresses this issue by streamlining data input and reducing the complexity of ancillary file management.
Additionally, SWAT+ has been developed using modern Fortran and incorporating object-oriented programming techniques. This shift from Fortran 90, used in SWAT 2012, to modern Fortran facilitates easier code maintenance and development. SWAT+ also includes enhanced features for water management and hydrologic assessment that are required for accurate water balance simulations.
The rest of the sub-sections describe our approach for creating, calibrating, and processing the hydrological models. Creating a predefined watershed for SWAT+ requires preparing specific structures for streams, watersheds, and sub-basins. These include defining hydrograph sequences, lake-stream connections, sub-basin boundaries, and water bodies for the model. For this purpose, we leverage the National Hydrography Dataset (NHD) Plus High Resolution (NHDPlus HR). It is worth noting that the NHD  has evolved significantly since 1970, starting with the 1:500,000-scale Reach File Version 1 (RF1), followed by the more detailed 1:100,000-scale RF3 in the 1990s, ultimately leading to the medium-resolution NHD in 1997. The enhanced NHDPlus (Versions 1 and 2) adds attributes like streamflow estimates and hydrologically conditioned catchments and provides 2.5 million identifiable channels across the contiguous United States (CONUS) (Dewald, 2017). The NHDPlus V2 has been used for several large-scale implementations for hydrological modeling. For instance, the NAM (National Agroecosystem Model) (White et al., 2022) and the NHM  (National Hydrologic Model) (Regan et al., 2018) rely on moderate resolution NHD (National Hydrography Dataset) (1:100k) for hydrographical connections. The NHDPlus High Resolution (NHDPlus HR) used in this study, introduced in 2015 (Buto and Anderson, 2020), offers 1:24,000-scale or better detail using 10m elevation data and provides 27 million identifiable channels (~20 times larger than NHDPlus V2). 
Given NHDPlus HR’s capabilities, including its complete coverage for CONUS, we have generated SWAT+ predefined hydrographical models based on the NHDPlus HR streams, waterbodies, and catchments. We designed a hierarchical database for data management to distribute geospatial and hydrographical data based on a Vectorized Processing Unit Identifier (VPUID) according to NHDPlus HR. Furthermore, we connected our codebase to the National Water Information System API to extract streamflow data within CONUS, providing information for more than 36,000 USGS stations. We used PRISM grid data to distribute weather stations for the watershed models at 4km resolution (PRISM Climate Group, 2014). For the energy balance of the model, we used the National Solar Radiation Database (NSRDB) for the North American region and extracted Global Horizontal Irradiance (GHI), wind speed, and relative humidity corresponding to the defined weather stations for the model (Sengupta et al., 2018).
The design of this data extraction process enables us to create SWAT+ models with all necessary inputs in optimized data distribution and extraction methods. This process also ensures we generate a standard model for various geographic extents, from a single HUC12/HUC8 to multiple HUC12/HUC8 across CONUS. Applying this data processing generates SWAT+ models for the drainage area of any desired USGS streamflow station. The entire process is encapsulated in a Python program module, which we call SWATGenX.
The next step in our automation procedure, SWATGenX, includes the integration of QSWAT+ and SWAT+Editor APIs with SWATGenX. The QSWAT+ API automates the generation of the SWAT+ QGIS project and database based on the predefined watershed generated by SWATGenX. The product of QSWAT+ is an SQL database, and we connect that database with the SWAT+Editor API to write weather and model input files and run the model for one successful year. This is the final checking point for creating SWAT+ models. Creating a SWAT+ model takes 20 seconds for small areas to just a few minutes for most models. 
Figure XX shows the SWAT+ models that we extracted across CONUS. The entire record of streamflow stations (active or inactive) is more than 270,000. To narrow it down, we used Federally Prioritized Stream gages (FPS), which contain over 27 thousand streamflow station data. Based on FPS sites, we extracted a maximum of 3 models from each HUC4 under the condition that the stations have 20 years of records with less than a 10% gap between 2000 and 2020. This has resulted in 327 models across CONUS. We used the USGS stations from CAMEL with similar eligibility conditions to enrich our sampling further. 
The source code of the Python program that performs the described automation tasks and generates SWAT+ models is provided in the manuscript’s Software and Data Availability section. The work's web application is set up and accessible at www://ciwre-bae.msu.edu 


2.2.2. Full-scale implementation for Michigan State
 Finally, we developed consistent groundwater datasets, including hydraulic conductivity, groundwater head, transmissivity, and aquifer depth. These datasets were created using the lithological data from 650,000 water wells across Michigan, processed with Empirical Bayesian Kriging (EBK). After that, using the SWAT+ project and input created, we include the Gwflow module (Bailey et al., 2020). For SWAT+ with the GWflow module, we aggregate the groundwater hydraulic properties into four quantiles to represent four homogeneous regions for each variable in a watershed. Gwflow, built on a 250 m grid, simulates groundwater flow and groundwater-surface water interaction at rivers and lakes. Figure 1 summarizes the automated workflow for creating and storing SWAT+ models.  
Figure 1. Flowchart of Automatic SWAT+ model’s preparation.

2.2.2 Michigan Hydrological model coverage
We utilized this workflow to extract predefined watersheds for all streamflow station drainage areas within the Michigan Lower Peninsula, adhering to the following criteria: 1) Only streamflow stations with a maximum drainage area of 3,500 km2, were used, which is a standard size for HUC8 watersheds. 2) Stations selected had less than a 10% data gap between 1999 to 2022. These strategies enabled the extraction of 58 SWAT+ models representing surface water and groundwater hydrological cycles within Michigan’s Lower Peninsula. Additional streamflow stations were included in the watersheds to utilize all available streamflow data for model calibration fully, provided they had complete data for the simulation period. As a result, 71 streamflow monitoring stations were incorporated into the model calibrations.
 Figure 1 shows the model boundaries, the HUC8 watershed boundaries, and the streamflow stations included in model calibration. Accordingly, the number of HRUs ranges from a minimum of 1,564 to a maximum of 42,480, with a median of 14,049 HRUs. The total size of all watersheds is 5,825,283 ha, while the total area of Michigan LP is 10,402,000 ha. Moreover, Table S1 presents the distribution of 16 major land uses within Michigan’s Lower Peninsula, based on the National Land Cover Database (NLCD) 2021 dataset. There are a variety of SWAT+ models with different combinations of land uses, from watersheds with more than 90% urban landuse to watersheds with more than 80% agriculture. The distribution of 4 primary land uses (agriculture and urban, forest, and wetlands) for the 58 SWAT+ are shown in Figure S1. 
 
Figure 1. 58 SWAT+gwflow models created for 58 unique streamflow monitoring stations within Michigan’s Lower Peninsula. 
2.2.3 Hydrological model calibration procedure
We performed parameter calibration of hydrological models using a modified version of the Particle Swarm Optimization (PSO) algorithm (Rafiei et al., 2022). The PSO algorithm calibrates the hydrological parameters using different techniques in population management and optimizing model performance. To find the best global optimum, each particle in PSO searches the solution space, improves its local best solution in each iteration, and collectively moves toward the global best solution found among all particles. The total number of Iterations defined for PSO in this study was 75, with 50 particles. We also defined an early stopping to terminate the calibration. The minimum number of iterations before checking the early stopping was 10 for the initial optimization of the models. For extensive calibration, the early stopping moved to at least 50 iterations. The SWAT+ parameters and their respective min/max and updating operations are presented in Tables S2 and S3. 
We have implemented two straightforward methods to terminate calibration processes. The first method involves monitoring the standard deviation (std) of the overall objective function (weighted streamflow, groundwater head, static water level, and crop yield). For calibration, the early stopping mechanism begins after the 50th iteration. The calibration process is terminated if the standard deviation remains below 0.001 for ten consecutive iterations. 


