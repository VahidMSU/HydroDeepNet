I have written an example of modified PSO
The algorithm can be executed. 
The algorithm has a lot more room to improve
